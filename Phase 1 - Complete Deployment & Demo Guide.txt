Phase 1 - Complete Deployment & Demo Guide
EC2 User Management System v1.0.1
Purpose: Step-by-step guide to deploy, test, and showcase all Phase 1 features on EC2
Time Required: 60-90 minutes
 Skill Level: Beginner-friendly (detailed instructions)

ðŸ“‹ Table of Contents
Prerequisites
EC2 Instance Setup
Installation
Configuration
Testing Suite
Feature Demonstrations
Real-World Scenarios
Troubleshooting

1. Prerequisites {#prerequisites}
What You Need
AWS Account:
Active AWS account
Permissions to launch EC2 instances
SSH key pair created
Local Machine:
SSH client (Terminal on Mac/Linux, PuTTY on Windows)
Text editor (VS Code, Sublime, or nano)
All Phase 1 files downloaded
Files Required (29 total):
phase1/
â”œâ”€â”€ user.sh
â”œâ”€â”€ user_mgmt.conf
â”œâ”€â”€ install.sh
â”œâ”€â”€ test_phase1.sh
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ logging.sh
â”‚   â”œâ”€â”€ validation.sh
â”‚   â”œâ”€â”€ config_validation.sh
â”‚   â”œâ”€â”€ helpers.sh
â”‚   â”œâ”€â”€ json.sh
â”‚   â”œâ”€â”€ help.sh
â”‚   â”œâ”€â”€ json_input.sh
â”‚   â”œâ”€â”€ user_add.sh
â”‚   â”œâ”€â”€ user_delete.sh
â”‚   â”œâ”€â”€ user_update.sh
â”‚   â”œâ”€â”€ user_lock.sh
â”‚   â”œâ”€â”€ group_add.sh
â”‚   â”œâ”€â”€ group_delete.sh
â”‚   â”œâ”€â”€ group_update.sh
â”‚   â”œâ”€â”€ view.sh
â”‚   â”œâ”€â”€ view_json.sh
â”‚   â”œâ”€â”€ search.sh
â”‚   â”œâ”€â”€ search_json.sh
â”‚   â”œâ”€â”€ report.sh
â”‚   â”œâ”€â”€ report_json.sh
â”‚   â””â”€â”€ export.sh
â””â”€â”€ examples/
    â”œâ”€â”€ users.json
    â”œâ”€â”€ roles.json
    â”œâ”€â”€ groups.json
    â”œâ”€â”€ deletions.json
    â””â”€â”€ README.md


2. EC2 Instance Setup {#ec2-setup}
Step 1: Launch EC2 Instance
Navigate to EC2 Console:
AWS Console â†’ EC2 â†’ Launch Instance

Instance Configuration:
Name: user-mgmt-demo


AMI:


Amazon Linux 2023 AMI (recommended)
OR Ubuntu Server 22.04 LTS
Instance Type:


t3.micro (Free Tier eligible)
1 vCPU, 1 GB RAM
Key Pair:


Select existing or create new
Download .pem file (keep secure!)
Network Settings:


Create security group: user-mgmt-sg
Allow SSH (port 22) from Your IP only
Description: "User Management Demo"
Storage:


8 GB gp3 (default is fine)
Click: "Launch Instance"


Wait 2-3 minutes for instance to initialize
Step 2: Configure SSH Access
For Mac/Linux:
# Set correct permissions on key file
chmod 400 ~/Downloads/your-key.pem

# Create SSH config entry (optional but convenient)
nano ~/.ssh/config

# Add this:
Host usermgmt
    HostName <EC2-PUBLIC-IP>
    User ec2-user
    IdentityFile ~/Downloads/your-key.pem
    
# Save: Ctrl+O, Enter, Ctrl+X

# Now you can connect with:
ssh usermgmt

For Windows (PuTTY):
1. Convert .pem to .ppk using PuTTYgen
2. Open PuTTY
3. Host: ec2-user@<EC2-PUBLIC-IP>
4. Connection â†’ SSH â†’ Auth â†’ Browse for .ppk file
5. Save session as "usermgmt"
6. Click "Open"

Step 3: First Connection
# Connect to EC2
ssh usermgmt
# OR
ssh -i ~/Downloads/your-key.pem ec2-user@<EC2-PUBLIC-IP>

# You should see:
   ,     #_
   ~\_  ####_        Amazon Linux 2023
  ~~  \_#####\
  ~~     \###|
  ~~       \#/ ___
   ~~       V~' '->
    ~~~         /
      ~~._.   _/
         _/ _/
       _/m/'

# Update system
sudo yum update -y
# OR for Ubuntu:
sudo apt update && sudo apt upgrade -y

# Install dependencies
sudo yum install -y jq git tar gzip
# OR for Ubuntu:
sudo apt install -y jq git tar gzip


3. Installation {#installation}
Step 1: Create Project Structure
# Create main directory
sudo mkdir -p /opt/admin_dashboard/{scripts/lib,config,scripts/examples}

# Set ownership
sudo chown -R $USER:$USER /opt/admin_dashboard

# Verify structure
tree /opt/admin_dashboard

Step 2: Upload Files to EC2
Method A: SCP (Recommended)
From your local machine:
# Upload main script
scp -i ~/Downloads/your-key.pem user.sh ec2-user@<EC2-IP>:/tmp/

# Upload all lib files
scp -i ~/Downloads/your-key.pem lib/*.sh ec2-user@<EC2-IP>:/tmp/lib/

# Upload config
scp -i ~/Downloads/your-key.pem user_mgmt.conf ec2-user@<EC2-IP>:/tmp/

# Upload examples
scp -i ~/Downloads/your-key.pem examples/*.json examples/README.md ec2-user@<EC2-IP>:/tmp/examples/

# Upload test suite
scp -i ~/Downloads/your-key.pem test_phase1.sh ec2-user@<EC2-IP>:/tmp/

Method B: Create Files Directly on EC2
# SSH into EC2
ssh usermgmt

# Create main script
nano /tmp/user.sh
# Paste content from user.sh
# Save: Ctrl+O, Enter, Ctrl+X

# Repeat for each file...

Method C: Git Clone (If you have a repo)
ssh usermgmt
cd /tmp
git clone https://github.com/yourusername/ec2-user-mgmt.git
cd ec2-user-mgmt

Step 3: Move Files to Correct Locations
# On EC2 instance
ssh usermgmt

# Move main script
sudo mv /tmp/user.sh /opt/admin_dashboard/scripts/
sudo chmod +x /opt/admin_dashboard/scripts/user.sh

# Move library files
sudo mv /tmp/lib/*.sh /opt/admin_dashboard/scripts/lib/
sudo chmod +x /opt/admin_dashboard/scripts/lib/*.sh

# Move config
sudo mv /tmp/user_mgmt.conf /opt/admin_dashboard/config/

# Move examples
sudo mv /tmp/examples/* /opt/admin_dashboard/scripts/examples/

# Move test suite
sudo mv /tmp/test_phase1.sh /opt/admin_dashboard/scripts/
sudo chmod +x /opt/admin_dashboard/scripts/test_phase1.sh

# Verify installation
ls -la /opt/admin_dashboard/scripts/
ls -la /opt/admin_dashboard/scripts/lib/
ls -la /opt/admin_dashboard/scripts/examples/
ls -la /opt/admin_dashboard/config/

Step 4: Create Required Directories
# Create log directory
sudo mkdir -p /var/log
sudo touch /var/log/user_mgmt.log
sudo chmod 640 /var/log/user_mgmt.log

# Create backup directory
sudo mkdir -p /var/backups/users/passwords
sudo chmod 700 /var/backups/users
sudo chmod 700 /var/backups/users/passwords

# Verify
ls -la /var/log/user_mgmt.log
ls -la /var/backups/users/

Step 5: Create Symbolic Link (Optional)
# Create system-wide command
sudo ln -s /opt/admin_dashboard/scripts/user.sh /usr/local/bin/user-mgmt

# Now you can run:
sudo user-mgmt --help
# Instead of:
sudo /opt/admin_dashboard/scripts/user.sh --help


4. Configuration {#configuration}
Step 1: Review Default Config
# View current config
cat /opt/admin_dashboard/config/user_mgmt.conf

# You'll see:
DEFAULT_PASSWORD="P@ssword1234!"
PASSWORD_LENGTH=16
PASSWORD_EXPIRY_DAYS=90
# ... etc

Step 2: Customize Configuration
# Edit config file
sudo nano /opt/admin_dashboard/config/user_mgmt.conf

# IMPORTANT: Change the default password!
DEFAULT_PASSWORD="YourStrongPassword123!"

# Adjust other settings as needed:
PASSWORD_LENGTH=20              # Longer is better
PASSWORD_EXPIRY_DAYS=60         # More frequent changes
USE_UNICODE="no"                # If terminal doesn't support emoji

# Save: Ctrl+O, Enter, Ctrl+X

Step 3: Test Configuration
# Navigate to scripts directory
cd /opt/admin_dashboard/scripts

# Run version check (tests config loading)
sudo ./user.sh --version

# Should output:
# EC2 User Management System v1.0.1
# Build: 2024-01-15

# Test config validation
sudo ./user.sh --view summary

# Should show system summary without errors

Step 4: Test Invalid Config (Config Validation Demo)
# Backup original config
sudo cp /opt/admin_dashboard/config/user_mgmt.conf /tmp/user_mgmt.conf.backup

# Create intentionally broken config
sudo nano /opt/admin_dashboard/config/user_mgmt.conf

# Change these values to invalid ones:
DEFAULT_PASSWORD="weak"           # Too short (< 8 chars)
PASSWORD_EXPIRY_DAYS="abc"        # Not a number
MIN_USER_UID="not_a_number"       # Invalid
BACKUP_DIR="/this/does/not/exist" # Missing directory

# Save and try to run
sudo ./user.sh --view summary

# Output will show:
# âš ï¸  Config Warning: DEFAULT_PASSWORD too short (min 8 chars, current: 4)
# âœ— Config Error: PASSWORD_EXPIRY_DAYS must be numeric (current: abc)
# âœ— Config Error: MIN_USER_UID must be numeric (current: not_a_number)
# âš ï¸  Config Warning: BACKUP_DIR doesn't exist: /this/does/not/exist (will be created)
# 
# â„¹ï¸  Config validation: 2 error(s), 2 warning(s)
# âœ— Please fix config errors in: /opt/admin_dashboard/config/user_mgmt.conf

# Restore working config
sudo cp /tmp/user_mgmt.conf.backup /opt/admin_dashboard/config/user_mgmt.conf

# Verify it works
sudo ./user.sh --version


5. Testing Suite {#testing}
Step 1: Run Complete Test Suite
cd /opt/admin_dashboard/scripts

# Run all tests
sudo ./test_phase1.sh all

# Watch output:
========================================
Phase 1 Test Suite v1.0.1
========================================

Pre-Flight Checks
âœ“ Running as root
âœ“ user.sh found
âœ“ user.sh is executable
âœ“ jq is installed
âœ“ Test log: /tmp/phase1_test_20240115_143022.log

Running All Tests
â†’ Testing: Script version
âœ“ PASS: Version check (EC2 User Management System v1.0.1)

â†’ Testing: Add user from text file
âœ“ PASS: User created from text file

â†’ Testing: Add user with random password
âœ“ PASS: Random password generated and saved

[... 23 more tests ...]

========================================
Test Results
========================================
Tests Run:     26
Tests Passed:  26
Tests Failed:  0
Tests Skipped: 0

Success Rate: 100%

âœ“ ALL TESTS PASSED!

Phase 1 is ready for production deployment!

Test log saved to: /tmp/phase1_test_20240115_143022.log

Step 2: Review Test Log
# View detailed test log
cat /tmp/phase1_test_*.log

# Sample output:
[2024-01-15 14:30:22] Version: EC2 User Management System v1.0.1
[2024-01-15 14:30:23] Created user: testuser001
[2024-01-15 14:30:24] Created user from JSON: testuser003
[2024-01-15 14:30:25] Locked user: testuser001
[2024-01-15 14:30:26] Unlocked user: testuser001

Step 3: Run Individual Test Categories
# Test only user operations
sudo ./test_phase1.sh add-user

# Test only reports
sudo ./test_phase1.sh reports

# Test only exports
sudo ./test_phase1.sh export

# Test only group operations
sudo ./test_phase1.sh groups


6. Feature Demonstrations {#demonstrations}
Demo 1: Basic User Management
1.1: View Current System State
cd /opt/admin_dashboard/scripts

# View system summary
sudo ./user.sh --view summary

# Output:
==========================================
User Management System Summary
==========================================

USERS:
  Total Users:      3
  Active:           3
  Locked:           0

GROUPS:
  Total Groups:     5
  Empty Groups:     0

SUDO ACCESS:
  Users with Sudo:  1

SHELL DISTRIBUTION:
  /bin/bash:        3 users
  /sbin/nologin:    0 users

==========================================

1.2: View All Users
sudo ./user.sh --view users

# Output:
==========================================
All Users on System
==========================================
USERNAME        UID    PRIMARY_GROUP   SHELL                STATUS   EXPIRES
--------------------------------------------------------------------------------
ec2-user        1000   ec2-user        /bin/bash            ACTIVE   Never
--------------------------------------------------------------------------------
Total: 1 users

1.3: Create Test Users File
# Create sample users file
cat > /tmp/new_users.txt << 'EOF'
alice:Alice Johnson - Developer:90:a:yes:
bob:Bob Smith - Tester:180:a:no:random
charlie:Charlie Brown - DevOps::a:yes:random
diana:Diana Prince - Manager:365:a:no:
EOF

# View the file
cat /tmp/new_users.txt

1.4: Test Dry-Run Mode
# Test without making changes
sudo ./user.sh --add user --names /tmp/new_users.txt --dry-run

# Output:
==========================================
Adding Users from: /tmp/new_users.txt
ðŸ” DRY-RUN MODE
==========================================

ðŸ” [DRY-RUN] Would create user: alice
   - Comment: Alice Johnson - Developer
   - Home: /home/alice
   - Shell: /bin/bash
   - Account expires: 2024-04-15
   - Sudo: enabled
   - Password expires every: 90 days

ðŸ” [DRY-RUN] Would create user: bob
   - Comment: Bob Smith - Tester
   - Home: /home/bob
   - Shell: /bin/bash
   - Account expires: 2024-07-14
   - Password: random (unique)
   - Password expires every: 90 days

[... continues for charlie and diana ...]

==========================================
Summary:
  Total processed: 4
  Created: 4
  Skipped: 0
  Failed: 0
==========================================

1.5: Actually Create Users
# Create users for real
sudo ./user.sh --add user --names /tmp/new_users.txt

# Output shows actual creation with passwords
ðŸ‘¤ Creating user: alice
   âœ“ User created
   ðŸ” Default password set
   ðŸ”„ Must change password on first login
   â±ï¸  Password expires every: 90 days
   ðŸ“… Account expires: 2024-04-15
   ðŸ” Sudo access: granted
   ðŸ’¬ Comment: Alice Johnson - Developer
   ðŸš Shell: /bin/bash

ðŸ‘¤ Creating user: bob
   âœ“ User created
   ðŸ”‘ Random password: Xt9#mK2pL4vN8qR1
   ðŸ”„ Must change password on first login
   â±ï¸  Password expires every: 90 days
   ðŸ“… Account expires: 2024-07-14
   ðŸ’¬ Comment: Bob Smith - Tester
   ðŸš Shell: /bin/bash
   ðŸ“„ Password saved: /var/backups/users/passwords/bob_20240115_143500.txt

[... continues ...]

==========================================
Summary:
  Total processed: 4
  Created: 4
  Skipped: 0
  Failed: 0
==========================================

1.6: Verify Users Created
# View all users again
sudo ./user.sh --view users

# Now shows:
USERNAME        UID    PRIMARY_GROUP   SHELL                STATUS   EXPIRES
--------------------------------------------------------------------------------
ec2-user        1000   ec2-user        /bin/bash            ACTIVE   Never
alice           1001   alice           /bin/bash            ACTIVE   2024-04-15
bob             1002   bob             /bin/bash            ACTIVE   2024-07-14
charlie         1003   charlie         /bin/bash            ACTIVE   Never
diana           1004   diana           /bin/bash            ACTIVE   2025-01-15
--------------------------------------------------------------------------------
Total: 5 users

1.7: View Detailed User Information
# View alice's details
sudo ./user.sh --view user --name alice

# Output:
==========================================
User Details: alice
==========================================

BASIC INFORMATION:
  Username:         alice
  UID:              1001
  Primary Group:    alice (1001)
  Home Directory:   /home/alice
  Shell:            /bin/bash
  Comment:          Alice Johnson - Developer

ACCOUNT STATUS:
  Status:           ACTIVE

GROUPS:
  Primary:          alice (1001)
  All Groups:       alice sudo

LOGIN INFORMATION:
  Last Login:       Never

ACCOUNT EXPIRATION:
  Account Expires:  Apr 15 2024

RESOURCE USAGE:
  Home Directory:   4.0K
  Active Processes: 0
  Cron Jobs:        0

SUDO ACCESS:
  Has Sudo:         YES âš ï¸

==========================================

Demo 2: Input Validation
2.1: Test Invalid Username
# Create file with invalid username
cat > /tmp/invalid_users.txt << 'EOF'
Invalid-User:Test:90:a:no:
123startwithnumber:Test:90:a:no:
user with spaces:Test:90:a:no:
EOF

# Try to add
sudo ./user.sh --add user --names /tmp/invalid_users.txt

# Output:
âœ— INVALID user NAME: 'Invalid-User'
   Rules: Start with a-z or _, only use a-z 0-9 _ -, max 32 chars

âœ— INVALID user NAME: '123startwithnumber'
   Rules: Start with a-z or _, only use a-z 0-9 _ -, max 32 chars

âœ— INVALID user NAME: 'user with spaces'
   Rules: Start with a-z or _, only use a-z 0-9 _ -, max 32 chars

==========================================
Summary:
  Total processed: 3
  Created: 0
  Skipped: 0
  Failed: 3
==========================================

2.2: Test Invalid Date Format
# Create user with invalid expiry date
cat > /tmp/bad_date.txt << 'EOF'
testuser:Test User:not-a-date:a:no:
EOF

sudo ./user.sh --add user --names /tmp/bad_date.txt

# Output:
âœ— Invalid expiry date for testuser: not-a-date

==========================================
Summary:
  Total processed: 1
  Created: 0
  Skipped: 0
  Failed: 1
==========================================

Demo 3: User Lock/Unlock
3.1: Lock a User
# Lock bob's account
sudo ./user.sh --lock user --name bob --reason "Security incident - suspicious activity"

# Output:
ðŸ”’ Locking user: bob
   Reason: Security incident - suspicious activity
   âœ“ User locked successfully

User 'bob' is now locked:
  - Cannot login via SSH or terminal
  - Existing sessions remain active
  - All data preserved
  - Can be unlocked: ./user.sh --unlock user --name bob

3.2: Verify Lock Status
# Check bob's status
sudo ./user.sh --view user --name bob

# Shows:
ACCOUNT STATUS:
  Status:           LOCKED

# Also verify with system command
sudo passwd -S bob
# Output: bob L 01/15/2024 0 99999 7 -1 (Password locked.)

3.3: Unlock User
# Unlock bob
sudo ./user.sh --unlock user --name bob

# Output:
ðŸ”“ Unlocking user: bob
   âœ“ User unlocked successfully

User 'bob' is now unlocked and can login

Demo 4: JSON Operations
4.1: Create Users from JSON
# Create JSON file
cat > /tmp/team_members.json << 'EOF'
{
  "users": [
    {
      "username": "john",
      "comment": "John Doe - Backend Developer",
      "groups": ["developers", "docker"],
      "shell": "/bin/bash",
      "expire_days": 180,
      "password_policy": {
        "type": "random",
        "expiry_days": 90
      }
    },
    {
      "username": "jane",
      "comment": "Jane Smith - Frontend Developer",
      "groups": ["developers", "git"],
      "shell": "/bin/bash",
      "expire_days": 180,
      "password_policy": {
        "type": "random",
        "expiry_days": 60
      }
    }
  ]
}
EOF

# Add users from JSON
sudo ./user.sh --add user --input /tmp/team_members.json --format json

# Output (JSON format):
{
  "operation": "bulk_add_users_from_json",
  "timestamp": "2024-01-15 14:45:30",
  "source_file": "/tmp/team_members.json",
  "results": [
    {"username":"john","status":"success","uid":1005},
    {"username":"jane","status":"success","uid":1006}
  ],
  "summary": {
    "total": 2,
    "success": 2,
    "failed": 0,
    "duration_seconds": 2
  }
}

4.2: Test Invalid JSON Structure
# Create malformed JSON
cat > /tmp/bad.json << 'EOF'
{
  "user": [
    {"username": "test"}
  ]
}
EOF

# Try to use it
sudo ./user.sh --add user --input /tmp/bad.json --format json

# Output:
{"error":"Invalid JSON structure - missing 'users' array","file":"/tmp/bad.json"}

4.3: Apply Roles from JSON
# Use the provided example
sudo ./user.sh --apply-roles /opt/admin_dashboard/scripts/examples/roles.json

# Output shows role assignments
{
  "operation": "apply_roles",
  "timestamp": "2024-01-15 14:50:00",
  "source_file": "/opt/admin_dashboard/scripts/examples/roles.json",
  "results": [
    {"username":"alice","role":"senior_developer","status":"success","groups":"developers,git,docker,deploy"},
    {"username":"bob","role":"qa_tester","status":"success","groups":"testers,qa"}
  ],
  "summary": {
    "total": 8,
    "success": 8,
    "failed": 0
  }
}

Demo 5: Search & Filter
5.1: Search Users by Pattern
# Search for users containing "alice"
sudo ./user.sh --search users --pattern "alice"

# Output:
==========================================
Search Results: Users
Pattern: alice
==========================================

Username: alice (UID: 1001)
  Status:        ACTIVE
  Primary Group: alice
  Shell:         bash

Found: 1 user(s)

5.2: Search Users with Sudo
# Find all sudo users
sudo ./user.sh --search users --status sudo

# Output:
==========================================
Search Results: Users
Status: sudo
==========================================

Username: ec2-user (UID: 1000)
  Status:        ACTIVE
  Primary Group: ec2-user
  Shell:         bash

Username: alice (UID: 1001)
  Status:        ACTIVE
  Primary Group: alice
  Shell:         bash

Username: charlie (UID: 1003)
  Status:        ACTIVE
  Primary Group: charlie
  Shell:         bash

Found: 3 user(s)

5.3: JSON Output for Search
# Get JSON output
sudo ./user.sh --search users --status sudo --json

# Output (formatted):
[
  {
    "username": "ec2-user",
    "uid": 1000,
    "primary_group": "ec2-user",
    "groups": ["ec2-user","adm","wheel","systemd-journal"],
    "shell": "bash",
    "status": "ACTIVE"
  },
  {
    "username": "alice",
    "uid": 1001,
    "primary_group": "alice",
    "groups": ["alice","sudo","developers"],
    "shell": "bash",
    "status": "ACTIVE"
  }
]

Demo 6: Reports
6.1: Security Audit Report
sudo ./user.sh --report security

# Output:
==========================================
Security Audit Report
Generated: 2024-01-15 14:55:00
==========================================

1. USERS WITH SUDO ACCESS:
  âš ï¸  ec2-user (UID: 1000, Status: ACTIVE)
      Last login: Mon Jan 15 14:30:00 2024 from 203.0.113.45
  âš ï¸  alice (UID: 1001, Status: ACTIVE)
      Last login: Never
  âš ï¸  charlie (UID: 1003, Status: ACTIVE)
      Last login: Never

2. LOCKED ACCOUNTS:
  âœ“ None found

3. EXPIRED PASSWORDS:
  âœ“ None found

4. ACCOUNTS WITHOUT PASSWORD EXPIRY:
  âš ï¸  ec2-user (Status: ACTIVE)

5. EMPTY GROUPS:
  âœ“ No empty groups

6. USERS IN SYSTEM GROUPS (GID < 1000):
  âœ“ No regular users in system groups

7. USERS WITHOUT SHELL (Service Accounts):
  âœ“ All users have login shells

8. DUPLICATE UIDs:
  âœ“ No duplicate UIDs

9. DUPLICATE GIDs:
  âœ“ No duplicate GIDs

==========================================
SECURITY SUMMARY:
  Sudo users:           3
  Locked accounts:      0
  Expired passwords:    0
  No password expiry:   1
  Empty groups:         0
  System group members: 0
  Service accounts:     0
==========================================

6.2: Compliance Report
sudo ./user.sh --report compliance

# Shows password policy compliance, inactive accounts, etc.

6.3: Activity Report
# Last 7 days of activity
sudo ./user.sh --report activity --days 7

# Output:
==========================================
Activity Report (Last 7 days)
Generated: 2024-01-15 14:56:00
==========================================

1. LOGIN FREQUENCY:
  Top 10 Most Active Users:
    ec2-user: 5 logins

2. INACTIVE USERS (No login in last 7 days):
  âš ï¸  alice - Never logged in
  âš ï¸  bob - Never logged in
  âš ï¸  charlie - Never logged in
  âš ï¸  diana - Never logged in
  âš ï¸  john - Never logged in
  âš ï¸  jane - Never logged in

3. FAILED LOGIN ATTEMPTS (Last 7 days):
  Total failed attempts: 0

4. RECENT ACCOUNT MODIFICATIONS:
  [2024-01-15 14:35:22] add_user alice SUCCESS
  [2024-01-15 14:35:23] add_user bob SUCCESS
  [2024-01-15 14:35:24] add_user charlie SUCCESS
  [2024-01-15 14:35:25] add_user diana SUCCESS

==========================================

6.4: Storage Report
sudo ./user.sh --report storage

# Output:
==========================================
Storage Report
Generated: 2024-01-15 14:57:00
==========================================

1. TOP 10 LARGEST HOME DIRECTORIES:
  ec2-user: 24MB
  alice: 4MB
  bob: 4MB
  charlie: 4MB
  diana: 4MB
  john: 4MB
  jane: 4MB

2. STORAGE BY PRIMARY GROUP:
  ec2-user: 24MB
  alice: 4MB
  bob: 4MB
  charlie: 4MB
  diana: 4MB
  john: 4MB
  jane: 4MB

3. TOTAL STORAGE SUMMARY:
  Total home directories: 52MB (0.05GB)
  Number of users: 7
  Average per user: 7MB

4. ORPHANED FILES CHECK:
  Scanning /home for orphaned files...
  âœ“ No orphaned files found

5. LARGE FILES (>100MB):
  âœ“ No files larger than 100MB

==========================================

Demo 7: Export Data
7.1: Export to CSV
# Export all users to CSV
sudo ./user.sh --export users --output /tmp/users.csv --format csv

# Output:
==========================================
Exporting Data
==========================================
Type:    users
Format:  csv
Output:  /tmp/users.csv

âœ“ Export complete
  File: /tmp/users.csv
  Size: 1.2K

# View the file
cat /tmp/users.csv

# Output:
username,uid,primary_group,gid,home,shell,status,comment,last_login,groups
ec2-user,1000,ec2-user,1000,/home/ec2-user,/bin/bash,ACTIVE,"",Mon_Jan_15_14:30:00_2024,"ec2-user;adm;wheel"
alice,1001,alice,1001,/home/alice,/bin/bash,ACTIVE,"Alice Johnson - Developer",Never,"alice;sudo;developers"
bob,1002,bob,1002,/home/bob,/bin/bash,ACTIVE,"Bob Smith - Tester",Never,"bob;testers;qa"
charlie,1003,charlie,1003,/home/charlie,/bin/bash,ACTIVE,"Charlie Brown - DevOps",Never,"charlie;sudo;developers;deploy"
diana,1004,diana,1004,/home/diana,/bin/bash,ACTIVE,"Diana Prince - Manager",Never,"diana;managers"

7.2: Export to JSON
# Export all users to JSON
sudo ./user.sh --export users --output /tmp/users.json --format json

# View the file (formatted)
cat /tmp/users.json | jq .

# Output:
{
  "export_date": "2024-01-15T14:58:00Z",
  "export_by": "ec2-user",
  "users": [
    {
      "username": "ec2-user",
      "uid": 1000,
      "gid": 1000,
      "primary_group": "ec2-user",
      "home": "/home/ec2-user",
      "shell": "/bin/bash",
      "status": "ACTIVE",
      "comment": "",
      "last_login": "Mon Jan 15 14:30:00 2024",
      "groups": ["ec2-user", "adm", "wheel"]
    },
    {
      "username": "alice",
      "uid": 1001,
      "gid": 1001,
      "primary_group": "alice",
      "home": "/home/alice",
      "shell": "/bin/bash",
      "status": "ACTIVE",
      "comment": "Alice Johnson - Developer",
      "last_login": "Never",
      "groups": ["alice", "sudo", "developers"]
    }
  ]
}

7.3: Export Complete System State
# Export everything (users + groups + metadata)
sudo ./user.sh --export all --output /tmp/system_backup.json --format json

# View summary
cat /tmp/system_backup.json | jq '{export_date, hostname, system}'

# Output:
{
  "export_date": "2024-01-15T14:59:00Z",
  "hostname": "ip-172-31-45-123.ec2.internal",
  "system": {
    "total_users": 7,
    "total_groups": 12
  }
}

7.4: Export to Table Format
# Export as pretty table
sudo ./user.sh --export users --output /tmp/users_table.txt --format table

# View file
cat /tmp/users_table.txt

# Output:
==========================================
User Export - Table Format
Generated: 2024-01-15 15:00:00
==========================================

USERNAME        UID    PRIMARY_GROUP   SHELL                STATUS
------------------------------------------------------------------------
ec2-user        1000   ec2-user        bash                 ACTIVE
alice           1001   alice           bash                 ACTIVE
bob             1002   bob             bash                 ACTIVE
charlie         1003   charlie         bash                 ACTIVE
diana           1004   diana           bash                 ACTIVE
john            1005   john            bash                 ACTIVE
jane            1006   jane            bash                 ACTIVE
------------------------------------------------------------------------

Demo 8: Group Management
8.1: Create Groups
# Create groups file
cat > /tmp/new_groups.txt << 'EOF'
developers
testers
devops
managers
contractors
EOF

# Add groups
sudo ./user.sh --add group --names /tmp/new_groups.txt

# Output:
==========================================
Adding Groups from: /tmp/new_groups.txt
==========================================

ðŸ‘¥ Creating group: developers

âš ï¸  Group 'testers' already exists. Skipping...

ðŸ‘¥ Creating group: devops

ðŸ‘¥ Creating group: managers

âš ï¸  Group 'contractors' already exists. Skipping...

==========================================
Summary:
  Total processed: 5
  Created: 2
  Skipped: 3
  Failed: 0
==========================================

8.2: View All Groups
sudo ./user.sh --view groups

# Output:
==========================================
All Groups on System
==========================================
GROUP_NAME           GID    MEMBERS                                  COUNT
--------------------------------------------------------------------------------
developers           1010   alice,charlie,john,jane                  4
testers              1011   bob,jane                                 2
devops               1012   charlie                                  1
managers             1013   diana                                    1
contractors          1014   none                                     0
--------------------------------------------------------------------------------
Total: 5 groups

8.3: View Group Details
sudo ./user.sh --view group --name developers

# Output:
==========================================
Group Details: developers
==========================================

BASIC INFORMATION:
  Group Name:       developers
  GID:              1010
  Type:             User group

MEMBERS: 4
  alice (UID: 1001, primary: alice, ACTIVE)
  charlie (UID: 1003, primary: charlie, ACTIVE)
  john (UID: 1005, primary: john, ACTIVE)
  jane (UID: 1006, primary: jane, ACTIVE)

PRIMARY GROUP FOR: 0 users
  (not used as primary group)

==========================================

8.4: Add Members to Group
# Add bob to developers group
sudo ./user.sh --update group --name developers --add-members bob

# Output:
Adding members to group: developers
Members: bob

  âœ“ Added: bob

Summary: 1 added, 0 failed

Current members:
alice,charlie,john,jane,bob

8.5: Manage Groups from JSON
# Use example file
sudo ./user.sh --manage-groups /opt/admin_dashboard/scripts/examples/groups.json

# Shows creation/deletion of groups based on JSON

Demo 9: User Update Operations
9.1: Update User Password
# Reset alice's password
sudo ./user.sh --update user --name alice --reset-password

# Output:
==========================================
Password Reset: alice
==========================================

Generated random password

âœ“ Password reset successfully
âœ“ User MUST change password on next login

==========================================
Temporary Password: mN8pQ2xR5tK9wL3v
==========================================

âš ï¸  Securely provide this password to alice

Password saved to: /var/backups/users/passwords/alice_20240115_150500.txt

9.2: Change User Shell
# Change bob's shell to nologin (service account)
sudo ./user.sh --update user --name bob --shell d

# Output:
Changing shell for: bob
  Current: /bin/bash
  New:     /sbin/nologin

âœ“ Shell changed successfully

9.3: Add User to Multiple Groups
# Add diana to multiple groups
sudo ./user.sh --update user --name diana --add-to-groups "developers,managers,viewers"

# Output:
Adding diana to groups: developers,managers,viewers

  âœ“ Added to: developers
  âœ“ Added to: managers
  âœ“ Added to: viewers

Summary: 3 added, 0 failed

Current groups:
diana developers managers viewers

9.4: Set Account Expiration
# Set john's account to expire in 30 days
sudo ./user.sh --update user --name john --expire 30

# Output:
Updating account expiration for: john

Setting: 30 days from now (2024-02-14)

âœ“ Account expiration updated

Account expires                                        : Feb 14, 2024

9.5: Update Password Expiry Policy
# Make jane change password every 30 days (high security)
sudo ./user.sh --update user --name jane --password-expiry 30

# Output:
Updating password expiry policy for: jane

Setting: Password expires every 30 days

âœ“ Password expiry policy updated

Maximum number of days between password change        : 30

9.6: Update User Comment
# Update alice's description
sudo ./user.sh --update user --name alice --comment "Alice Johnson - Lead Developer"

# Output:
Updating comment for: alice
  Current: Alice Johnson - Developer
  New:     Alice Johnson - Lead Developer

âœ“ Comment updated successfully

Demo 10: User Deletion (Safe Methods)
10.1: Pre-Deletion Check
# Check what will happen before deleting
sudo ./user.sh --delete user --name john --check

# Output:
==========================================
Pre-Deletion Check: john
==========================================

USER INFORMATION:
  Username:        john
  UID:             1005
  Primary Group:   john (1005)
  Secondary Groups: john developers docker
  Comment:         John Doe - Backend Developer
  Home:            /home/john
  Shell:           /bin/bash
  Status:          ACTIVE

LOGIN STATUS:
  âœ“ Not logged in

ACTIVE PROCESSES:
  âœ“ No active processes

CRON JOBS:
  âœ“ No cron jobs

MAIL:
  âœ“ No mail

HOME DIRECTORY:
  â„¹ï¸  /home/john
     Size:  4.0K
     Files: 3

FILES OUTSIDE HOME:
  âœ“ No files outside home

SUDO ACCESS:
  âœ“ No sudo access

==========================================
âœ“ Safe to delete (no warnings)

NEXT STEPS:
  Delete: ./user.sh --delete user --name john
==========================================

10.2: Interactive Deletion
# Delete with prompts
sudo ./user.sh --delete user --name john

# Output:
==========================================
Interactive User Deletion: john
==========================================

Summary:
  User: john
  Status: Not logged in
  Processes: 0

Step 3: Backup user data?
Enter backup directory path (or 'skip'): /tmp/backups

ðŸ“¦ Creating backup: /tmp/backups/john_20240115_151000
  Backing up home directory...
  âœ“ Home backed up
  âœ“ Backup complete: /tmp/backups/john_20240115_151000

Step 4: Home directory
  [d] Delete home directory
  [k] Keep home directory
Choice [d/k]: d

Step 5: Final confirmation
  User: john
  Delete home: true
  Backup: /tmp/backups/john_20240115_151000

Proceed with deletion? [yes/no]: yes

ðŸ—‘ï¸  Deleting user: john
âœ“ User deleted successfully
ðŸ“¦ Backup saved: /tmp/backups/john_20240115_151000

10.3: View Backup Contents
# Check what was backed up
ls -la /tmp/backups/john_20240115_151000/

# Output:
total 24
drwx------. 2 root root 4096 Jan 15 15:10 .
drwxr-xr-x. 3 root root 4096 Jan 15 15:10 ..
-rw-------. 1 root root 2048 Jan 15 15:10 home_backup.tar.gz
-rw-------. 1 root root  256 Jan 15 15:10 metadata.txt
-rw-------. 1 root root    0 Jan 15 15:10 file_list.txt

# View metadata
cat /tmp/backups/john_20240115_151000/metadata.txt

# Output:
User Deletion Backup
====================
Username: john
UID: 1005
GID: 1005
Groups: john developers docker
Home: /home/john
Shell: /bin/bash
Backup Date: Mon Jan 15 15:10:00 UTC 2024
Deleted By: ec2-user

10.4: Batch Deletion from JSON
# Create deletion JSON
cat > /tmp/cleanup.json << 'EOF'
{
  "options": {
    "backup_dir": "/tmp/deletion_backups",
    "default_backup": true,
    "retention_days": 90
  },
  "deletions": [
    {
      "username": "jane",
      "backup": true,
      "delete_home": true,
      "reason": "Employee departure - last day completed"
    }
  ]
}
EOF

# Execute batch deletion
sudo ./user.sh --delete user --input /tmp/cleanup.json --format json

# Output (JSON):
{
  "operation": "batch_delete_users",
  "timestamp": "2024-01-15 15:15:00",
  "source_file": "/tmp/cleanup.json",
  "results": [
    {
      "username": "jane",
      "status": "success",
      "uid": 1006,
      "backup": "/tmp/deletion_backups/jane_20240115_151500"
    }
  ],
  "summary": {
    "total": 1,
    "success": 1,
    "failed": 0
  }
}

Demo 11: Recent Login Tracking
11.1: View Recent Logins (24 hours)
sudo ./user.sh --view recent-logins

# Output:
==========================================
Recent Logins
Period: Last 24 hours
Generated: 2024-01-15 15:20:00
==========================================

USERNAME        TIME                 FROM                 DURATION
------------------------------------------------------------------------
ec2-user        2024-01-15 09:30    203.0.113.45         Active (5h 50m)
ec2-user        2024-01-15 14:15    203.0.113.45         Logged out (1:05)
------------------------------------------------------------------------
Total logins: 2

11.2: View Logins for Specific User
# Check alice's login history (30 days)
sudo ./user.sh --view recent-logins --user alice --days 30

# Output:
==========================================
Recent Logins: alice
Period: Last 30 days
Generated: 2024-01-15 15:21:00
==========================================

USERNAME        TIME                 FROM                 DURATION
------------------------------------------------------------------------
No logins found in the specified period
------------------------------------------------------------------------

11.3: JSON Output for Logins
# Get login data in JSON format for processing
sudo ./user.sh --view recent-logins --days 7 --json

# Output:
[
  {
    "username": "ec2-user",
    "tty": "pts/0",
    "from": "203.0.113.45",
    "login_time": "Mon Jan 15 09:30:00 2024",
    "status": "active",
    "duration_seconds": 21000
  },
  {
    "username": "ec2-user",
    "tty": "pts/1",
    "from": "203.0.113.45",
    "login_time": "Mon Jan 15 14:15:00 2024",
    "status": "logged_out",
    "duration_seconds": 3900
  }
]


7. Real-World Scenarios {#scenarios}
Scenario 1: New Project Team Onboarding
Situation: New project starting, need to onboard 5 team members with different roles.
Step 1: Create groups.json
cat > /tmp/project_alpha_groups.json << 'EOF'
{
  "groups": [
    {
      "name": "project_alpha_dev",
      "action": "create",
      "members": []
    },
    {
      "name": "project_alpha_qa",
      "action": "create",
      "members": []
    },
    {
      "name": "project_alpha_deploy",
      "action": "create",
      "members": []
    }
  ]
}
EOF

sudo ./user.sh --manage-groups /tmp/project_alpha_groups.json

Step 2: Create roles.json
cat > /tmp/project_alpha_roles.json << 'EOF'
{
  "roles": {
    "project_lead": {
      "groups": ["project_alpha_dev", "project_alpha_deploy", "sudo"],
      "shell": "/bin/bash",
      "password_expiry_days": 30,
      "description": "Project lead with full access"
    },
    "developer": {
      "groups": ["project_alpha_dev"],
      "shell": "/bin/bash",
      "password_expiry_days": 60,
      "description": "Developer with code access"
    },
    "qa_engineer": {
      "groups": ["project_alpha_qa"],
      "shell": "/bin/bash",
      "password_expiry_days": 60,
      "description": "QA engineer with test access"
    }
  },
  "assignments": [
    {"username": "sarah_lead", "role": "project_lead"},
    {"username": "mike_dev", "role": "developer"},
    {"username": "lisa_dev", "role": "developer"},
    {"username": "tom_qa", "role": "qa_engineer"},
    {"username": "emma_qa", "role": "qa_engineer"}
  ]
}
EOF

sudo ./user.sh --apply-roles /tmp/project_alpha_roles.json

Step 3: Verify Team Setup
# View all project members
sudo ./user.sh --search users --pattern "project"

# View project groups
sudo ./user.sh --view group --name project_alpha_dev

# Export team roster
sudo ./user.sh --export users --output /tmp/project_alpha_roster.csv --format csv

Result: Complete team onboarded in under 5 minutes with proper permissions and security settings.
Scenario 2: Security Incident Response
Situation: Suspicious activity detected on user "bob" account at 2 AM.
Step 1: Immediate Lock
# Lock account immediately
sudo ./user.sh --lock user --name bob --reason "Security incident - unusual login from unknown IP at 02:00 UTC"

# Output confirms lock:
ðŸ”’ Locking user: bob
   Reason: Security incident - unusual login from unknown IP at 02:00 UTC
   âœ“ User locked successfully

Step 2: Gather Information
# Get detailed user info
sudo ./user.sh --view user --name bob

# Check recent activity
sudo ./user.sh --view recent-logins --user bob --days 7

# Check for active processes
ps -u bob

# Check for cron jobs
sudo crontab -l -u bob

Step 3: Pre-Deletion Assessment
# Run security check
sudo ./user.sh --delete user --name bob --check

# Review findings and decide on action

Step 4: Secure Deletion with Backup
# Delete with full backup for forensics
sudo ./user.sh --delete user --name bob --backup --backup-dir /var/security/incidents --force-logout --kill-processes

# Backup is preserved for security review
ls -la /var/security/incidents/bob_*

Step 5: Audit Trail
# Review all actions taken
grep "bob" /var/log/user_mgmt.log

# Generate security report
sudo ./user.sh --report security > /tmp/security_audit_$(date +%Y%m%d).txt

Result: Compromised account handled within minutes, full audit trail maintained, data preserved for investigation.
Scenario 3: Contractor Offboarding
Situation: 3-month contractor period ending, need to cleanly remove 4 contractor accounts.
Step 1: Lock Accounts First
# Lock all contractors (prevent login while reviewing)
for user in contractor1 contractor2 contractor3 contractor4; do
    sudo ./user.sh --lock user --name $user --reason "Contract period ended - $(date +%Y-%m-%d)"
done

Step 2: Wait Period (24-48 hours)
# Verify no active processes
for user in contractor1 contractor2 contractor3 contractor4; do
    echo "Checking $user:"
    ps -u $user 2>/dev/null || echo "  No processes"
    sudo crontab -l -u $user 2>/dev/null || echo "  No cron jobs"
done

Step 3: Create Batch Deletion JSON
cat > /tmp/contractor_offboard.json << 'EOF'
{
  "options": {
    "backup_dir": "/var/backups/contractors",
    "default_backup": true,
    "retention_days": 180
  },
  "deletions": [
    {
      "username": "contractor1",
      "backup": true,
      "delete_home": true,
      "reason": "3-month contract completed - deliverables accepted"
    },
    {
      "username": "contractor2",
      "backup": true,
      "delete_home": true,
      "reason": "3-month contract completed - deliverables accepted"
    },
    {
      "username": "contractor3",
      "backup": true,
      "delete_home": false,
      "reason": "3-month contract completed - code review pending"
    },
    {
      "username": "contractor4",
      "backup": true,
      "delete_home": true,
      "reason": "3-month contract completed - deliverables accepted"
    }
  ]
}
EOF

Step 4: Execute Batch Deletion
# Run batch deletion
sudo ./user.sh --delete user --input /tmp/contractor_offboard.json --format json > /tmp/offboard_results.json

# Review results
cat /tmp/offboard_results.json | jq .

Step 5: Verify and Document
# Verify users deleted
for user in contractor1 contractor2 contractor3 contractor4; do
    id $user 2>/dev/null || echo "$user: Successfully removed"
done

# Verify backups created
ls -la /var/backups/contractors/

# Generate final report
sudo ./user.sh --view summary > /tmp/post_offboard_summary.txt

Result: Clean, auditable contractor offboarding with backups preserved for required retention period.
Scenario 4: Compliance Audit Preparation
Situation: Annual security audit next week, need comprehensive documentation.
Step 1: Generate All Reports
# Create audit directory
mkdir -p /tmp/audit_2024

# Security audit
sudo ./user.sh --report security > /tmp/audit_2024/security_audit.txt

# Compliance report
sudo ./user.sh --report compliance > /tmp/audit_2024/compliance_report.txt

# Activity report (1 year)
sudo ./user.sh --report activity --days 365 > /tmp/audit_2024/activity_report.txt

# Storage report
sudo ./user.sh --report storage > /tmp/audit_2024/storage_report.txt

Step 2: Export System State
# Complete system export (JSON for easy parsing)
sudo ./user.sh --export all --output /tmp/audit_2024/system_state.json --format json

# User list (CSV for spreadsheet)
sudo ./user.sh --export users --output /tmp/audit_2024/all_users.csv --format csv

# Group list
sudo ./user.sh --export groups --output /tmp/audit_2024/all_groups.csv --format csv

Step 3: Specific Queries
# Find all sudo users
sudo ./user.sh --search users --status sudo --json > /tmp/audit_2024/sudo_users.json

# Find all locked accounts
sudo ./user.sh --view users --filter locked > /tmp/audit_2024/locked_accounts.txt

# Find accounts without password expiry
sudo ./user.sh --report compliance | grep "No password expiry" -A 20 > /tmp/audit_2024/no_expiry.txt

Step 4: Create Audit Package
# Compress all reports
cd /tmp
tar -czf audit_package_$(date +%Y%m%d).tar.gz audit_2024/

# List contents
tar -tzf audit_package_$(date +%Y%m%d).tar.gz

# File is ready to submit
ls -lh audit_package_*.tar.gz

Result: Complete audit package ready in under 10 minutes, all required documentation included.

8. Troubleshooting {#troubleshooting}
Issue 1: Permission Denied
Error:
âœ— This script must be run as root (use sudo)

Solution:
# Always use sudo
sudo ./user.sh --view users

# OR add to sudoers for frequent use
sudo visudo
# Add line:
your_username ALL=(ALL) NOPASSWD: /opt/admin_dashboard/scripts/user.sh

Issue 2: jq Not Found
Error:
âœ— jq is required for JSON operations

Solution:
# Amazon Linux
sudo yum install -y jq

# Ubuntu
sudo apt install -y jq

# Verify
jq --version

Issue 3: Config Validation Errors
Error:
âœ— Config Error: PASSWORD_EXPIRY_DAYS must be numeric (current: abc)

Solution:
# Edit config file
sudo nano /opt/admin_dashboard/config/user_mgmt.conf

# Fix the invalid value
PASSWORD_EXPIRY_DAYS=90  # Must be a number

# Test
sudo ./user.sh --version

Issue 4: User Already Exists
Error:
âš ï¸  User 'alice' already exists. Skipping...

Solution:
# Check if user exists
id alice

# If intentional, skip is correct behavior
# If need to recreate, delete first:
sudo ./user.sh --delete user --name alice --check
sudo ./user.sh --delete user --name alice

Issue 5: Group Doesn't Exist
Error:
âœ— Group 'developers' does not exist

Solution:
# Create the group first
echo "developers" > /tmp/group.txt
sudo ./user.sh --add group --names /tmp/group.txt

# Then add user to group
sudo ./user.sh --update user --name alice --add-to-groups developers

Issue 6: Cannot Delete System Group
Error:
ðŸ›‘ BLOCKED: Cannot delete system group (GID < 1000)

Solution:
# This is intentional protection
# System groups (GID < 1000) cannot be deleted
# Only user-created groups (GID >= 1000) can be deleted

# To verify GID:
getent group groupname

Issue 7: Log File Not Writable
Error:
Warning: Cannot write to /var/log/user_mgmt.log

Solution:
# Fix permissions
sudo touch /var/log/user_mgmt.log
sudo chmod 640 /var/log/user_mgmt.log
sudo chown root:root /var/log/user_mgmt.log

Issue 8: Backup Directory Missing
Warning:
âš ï¸  Config Warning: BACKUP_DIR doesn't exist (will be created)

Solution:
# Create backup directory
sudo mkdir -p /var/backups/users/passwords
sudo chmod 700 /var/backups/users
sudo chmod 700 /var/backups/users/passwords

# Verify
ls -la /var/backups/

Issue 9: Unicode Characters Not Displaying
Issue:
# Instead of âœ“ you see: ?
# Instead of âš ï¸ you see: ??

Solution:
# Edit config to use ASCII mode
sudo nano /opt/admin_dashboard/config/user_mgmt.conf

# Change:
USE_UNICODE="no"

# Save and test
sudo ./user.sh --view summary

# Now you'll see [OK] instead of âœ“

Issue 10: Test Suite Failures
Error:
âœ— FAIL: Add user from text file
  Error: Command failed

Solution:
# Check test log for details
cat /tmp/phase1_test_*.log

# Common causes:
# 1. Missing dependencies
sudo yum install -y jq

# 2. Permission issues
sudo chmod +x /opt/admin_dashboard/scripts/user.sh
sudo chmod +x /opt/admin_dashboard/scripts/lib/*.sh

# 3. Config errors
sudo ./user.sh --view summary  # Check for config warnings

# Re-run specific test
sudo ./test_phase1.sh add-user


9. Performance Benchmarks
Operations Per Minute (t3.micro)
# Benchmark: Add 100 users
time for i in {1..100}; do
    echo "testuser$i:Test User $i" >> /tmp/bulk_users.txt
done
time sudo ./user.sh --add user --names /tmp/bulk_users.txt

# Result: ~30 seconds (200 users/minute)

# Benchmark: View operations
time sudo ./user.sh --view users
# Result: <1 second

# Benchmark: Search operations
time sudo ./user.sh --search users --pattern "test"
# Result: <1 second

# Benchmark: Report generation
time sudo ./user.sh --report security
# Result: 2-3 seconds

# Benchmark: Export operations
time sudo ./user.sh --export all --output /tmp/export.json --format json
# Result: 3-4 seconds for 100 users


10. Cleanup & Next Steps
Complete Cleanup
# Remove all test users created
for user in alice bob charlie diana john jane sarah_lead mike_dev lisa_dev tom_qa emma_qa; do
    if id "$user" &>/dev/null; then
        sudo userdel -r "$user" 2>/dev/null
        echo "Removed: $user"
    fi
done

# Remove test groups
for group in developers testers devops managers contractors project_alpha_dev project_alpha_qa project_alpha_deploy; do
    if getent group "$group" &>/dev/null; then
        sudo groupdel "$group" 2>/dev/null
        echo "Removed group: $group"
    fi
done

# Clean temp files
rm -f /tmp/*.txt /tmp/*.json /tmp/*.csv
rm -rf /tmp/audit_2024 /tmp/backups

# View final state
sudo ./user.sh --view summary

Save Configuration
# Backup your customized config
sudo cp /opt/admin_dashboard/config/user_mgmt.conf ~/user_mgmt.conf.backup

# Export system state before Phase 2
sudo ./user.sh --export all --output ~/phase1_final_state.json --format json

Documentation
# Save all logs
sudo cp /var/log/user_mgmt.log ~/phase1_execution.log

# Create summary document
cat > ~/phase1_summary.txt << 'EOF'
Phase 1 - Deployment Complete
=============================

Date: $(date)
Instance: $(hostname)
Version: 1.0.1

Tests Passed: 26/26 (100%)
Users Created: 6
Groups Created: 5
Reports Generated: 4
Exports Performed: 3

System is ready for Phase 2 deployment.
EOF




